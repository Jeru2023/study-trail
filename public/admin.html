<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>学迹 · 家长控制台</title>
    <link rel="stylesheet" href="/css/admin.css" />
  </head>
  <body>
    <div class="admin-shell">
      <aside class="sidebar" data-component="parent-sidebar" data-open="false" data-active="analytics"></aside>

      <div class="workspace">
        <header class="topbar">
          <div class="topbar__search">
            <input type="search" placeholder="搜索..." disabled />
          </div>
          <div class="topbar__actions">
            <button type="button" class="icon-button icon-button--badge" id="notificationsButton" aria-label="消息中心">
              <span class="icon icon-envelope" aria-hidden="true"></span>
              <span class="badge" id="notificationsBadge" hidden>0</span>
            </button>
            <div class="user-chip">
              <span class="avatar" id="topbarAvatar">P</span>
              <div class="user-chip__meta">
                <span id="topbarUserName">家长</span>
                <span class="user-chip__role">Parent</span>
              </div>
            </div>
          </div>
        </header>

        <main class="content">
          <section class="view" data-view="analytics">
            <div class="page-header">
              <div>
                <h1>数据分析</h1>
                <p class="page-subtitle">用数据洞察积分趋势与学生表现，助力科学激励。</p>
              </div>
              <div class="page-actions">
                <button type="button" class="ghost-button" id="analyticsRefreshBtn">刷新数据</button>
              </div>
            </div>

            <p class="page-message" id="analyticsMessage"></p>

            <section id="analyticsSummary" class="analytics-summary"></section>

            <section class="analytics-controls">
              <div class="analytics-filters" id="analyticsSourceFilters"></div>
              <div
                class="analytics-ranges"
                id="analyticsRangeTabs"
                role="tablist"
                aria-label="数据分析时间范围"
              >
                <button type="button" class="chip-button" data-range="today" role="tab" aria-selected="false">
                  今日
                </button>
                <button type="button" class="chip-button" data-range="week" role="tab" aria-selected="false">
                  近 7 日
                </button>
                <button type="button" class="chip-button" data-range="month" role="tab" aria-selected="false">
                  近 30 日
                </button>
              </div>
            </section>

            <section class="analytics-grid">
              <article class="analytics-panel">
                <header class="analytics-panel__header">
                  <h2>学生积分排行榜</h2>
                  <span class="analytics-panel__meta" id="analyticsLeaderboardMeta"></span>
                </header>
                <div id="analyticsLeaderboard" class="analytics-leaderboard"></div>
              </article>

              <article class="analytics-panel">
                <header class="analytics-panel__header">
                  <h2>积分趋势</h2>
                  <span class="analytics-panel__meta" id="analyticsTrendMeta"></span>
                </header>
                <div id="analyticsTrendChart" class="analytics-trend"></div>
                <div id="analyticsSourceBreakdown" class="analytics-sources"></div>
              </article>
            </section>

            <section class="analytics-panel analytics-panel--full">
              <header class="analytics-panel__header">
                <h2>学生积分明细</h2>
                <div class="analytics-panel__actions">
                  <select id="analyticsStudentSelect" aria-label="选择学生查看积分明细"></select>
                  <button type="button" class="ghost-button ghost-button--small" id="analyticsStudentRefreshBtn">
                    刷新
                  </button>
                </div>
              </header>
              <div id="analyticsStudentSummary" class="analytics-student-summary"></div>
              <ul id="analyticsStudentHistory" class="analytics-history"></ul>
            </section>
          </section>

          <section class="view" data-view="plan-approvals" hidden>
            <div class="page-header">
              <div>
                <h1>计划审批</h1>
                <p class="page-subtitle">查看并审批学生提交的每日计划。</p>
              </div>
              <button type="button" class="primary-button" id="planApprovalsRefreshBtn">刷新</button>
            </div>
            <p class="page-message" id="planApprovalsMessage"></p>
            <div class="plan-approval-tabs" id="planApprovalsTabs" role="tablist" aria-label="学习计划审批筛选">
              <button
                type="button"
                class="chip-button chip-button--active"
                data-status="submitted"
                role="tab"
                aria-selected="true"
              >
                待审批
              </button>
              <button
                type="button"
                class="chip-button"
                data-status="approved"
                role="tab"
                aria-selected="false"
              >
                已通过
              </button>
              <button
                type="button"
                class="chip-button"
                data-status="rejected"
                role="tab"
                aria-selected="false"
              >
                已驳回
              </button>
            </div>
            <section id="planApprovalsList" class="plan-approval-list card"></section>
          </section>

          <section class="view" data-view="approvals" hidden>
            <div class="page-header">
              <div>
                <h1>打卡审批</h1>
                <p class="page-subtitle">查看孩子今日的打卡记录 <span id="approvalDateLabel"></span></p>
              </div>
              <button type="button" class="primary-button" id="refreshApprovalsBtn">刷新</button>
            </div>
            <p class="page-message" id="approvalMessage"></p>
            <div class="approval-tabs" id="approvalTabs" role="tablist" aria-label="打卡审批任务筛选">
              <button
                type="button"
                class="chip-button chip-button--active"
                data-tab="pending"
                role="tab"
                aria-selected="true"
              >
                待审批
              </button>
              <button
                type="button"
                class="chip-button"
                data-tab="unsubmitted"
                role="tab"
                aria-selected="false"
              >
                未提交
              </button>
              <button
                type="button"
                class="chip-button"
                data-tab="completed"
                role="tab"
                aria-selected="false"
              >
                已完成
              </button>
            </div>
            <section id="approvalList" class="card approval-list"></section>
          </section>

          <section class="view" data-view="notifications" hidden>
            <div class="page-header">
              <div>
                <h1>消息中心</h1>
                <p class="page-subtitle">查看与打卡相关的提醒和最新动态。</p>
              </div>
              <button type="button" class="ghost-button" id="notificationsMarkAll">全部设为已读</button>
            </div>
            <p class="page-message" id="notificationsMessage"></p>
            <ul class="notification-list" id="notificationList"></ul>
          </section>
        </main>
      </div>
    </div>

    <script type="module" src="/js/admin/main.js"></script>
  </body>
</html>
